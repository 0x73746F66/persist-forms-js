!function(e,t,n){var i=function r(i){if(e===this)return new r(i);var s={autoPersistAll:!0,keyPropName:"id",watching:[]};return this.options=t.extend({},s,e.PersistFormsOptions||{},i),t.fn.serializeObject=function(){var e=this,i={},r={},s={validate:/^[a-zA-Z][a-zA-Z0-9_]*(?:\[(?:\d*|[a-zA-Z0-9_]+)\])*$/,key:/[a-zA-Z0-9_]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_]+$/};return this.build=function(e,t,n){return e[t]=n,e},this.push_counter=function(e){return r[e]===n&&(r[e]=0),r[e]++},t.each(t(this).serializeArray(),function(){if(s.validate.test(this.name)){for(var r,o=this.name.match(s.key),a=this.value,c=this.name;(r=o.pop())!==n;)c=c.replace(new RegExp("\\["+r+"\\]$"),""),r.match(s.push)?a=e.build([],e.push_counter(c),a):r.match(s.fixed)?a=e.build([],r,a):r.match(s.named)&&(a=e.build({},r,a));i=t.extend(!0,i,a)}}),i},this};i.fn=i.prototype={init:function(){var e=this,n=e.options.keyPropName;return t(document).on("input change","form["+n+"] input,form["+n+"] select,form["+n+"] textarea",function(){var n=t(this).parent("form");PersistFormsInstance.set(n.prop(e.options.keyPropName),n.serializeObject())}),t("form["+n+"]").each(function(){var i=t(this).prop(n);e.options.watching.push(i),e.options.autoPersistAll&&e.restore(i)}),this},isJSON:function(e){return"string"!=typeof e||""===e?!1:/^[\],:{}\s]*$/.test(e.replace(/\\["\\\/bfnrtu]/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,"]").replace(/(?:^|:|,)(?:\s*\[)+/g,""))},get:function(e){return PersistFormsInstance.db.call(this,e)},set:function(e,t){return PersistFormsInstance.db.call(this,e,t)},restore:function(e,n){var i=this,r=this.get(e),s=this.options.keyPropName;return t.when(t("form["+s+'="'+e+'"] input,form['+s+'="'+e+'"] select,form['+s+'="'+e+'"] textarea').each(function(){var e=t(this),n=e.prop("name").replace(/\[\]+$/,"");if(null!==r&&r[n])if("SELECT"===this.tagName&&this.multiple)for(var i=0;i<r[n].length;i++)e.children("option").filter('[value="'+r[n][i]+'"]').prop("selected","selected");else if("radio"===this.type||"checkbox"===this.type)for(var s=0;s<r[n].length;s++)e.filter('[value="'+r[n][s]+'"]').prop("checked","checked");else e.val(r[n])})).then(function(){"function"==typeof n&&n.call(i,r,s)}),this},createCookie:function(e,t,n,i,r){"undefined"==typeof n&&(n=365),"string"!=typeof t&&(t=JSON.stringify(t));var s=e+"="+escape(t)+";";return n&&(n instanceof Date?isNaN(n.getTime())&&(n=new Date):n=new Date((new Date).getTime()+1e3*parseInt(n)*60*60*24),s+="expires="+n.toGMTString()+";"),i&&(s+="path="+i+";"),r&&(s+="domain="+r+";"),document.cookie=s,s},getCookie:function(e){var t=new RegExp("(?:^"+e+"|;s*"+e+")=(.*?)(?:;|$)","g"),n=t.exec(document.cookie);return null===n?null:this.isJSON(unescape(n[1]))?JSON.parse(unescape(n[1])):unescape(n[1])},db:function(t,n){var i;return function(){var t="testHasLocalStorage";try{return e.localStorage.setItem(t,t),e.localStorage.removeItem(t),!0}catch(n){return!1}}()===!0?"undefined"==typeof n?(i=e.localStorage.getItem(t),this.isJSON(i)?JSON.parse(i):i):e.localStorage.setItem(t,"string"!=typeof n?JSON.stringify(n):n):"undefined"==typeof n?(i=this.getCookie(t),this.isJSON(i)?JSON.parse(i):i):this.createCookie(t,"string"!=typeof n?JSON.stringify(n):n)}},e.PersistForms=i,PersistFormsInstance=(new i).init()}(window,jQuery);
//# sourceMappingURL=persistForms.min.js.map